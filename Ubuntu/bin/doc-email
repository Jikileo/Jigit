#!/bin/bash
############### TẬP TIN ĐƯỢC TẠO BỞI JIKILEO ###############
#-----------------------   Jiki   -------------------------#
#
# Name script: doc-email
# Author:		Jikileo
# Version:	1.2
# Email:		micae_vu@yahoo.com
# Description: Chương trình đọc email yahoo hotmail outlook
#              gmail                
#---------------------   KẾT THÚC  ------------------------#
#
##### START #####

# Kiểm tra shell
#set -e

# Thêm các biến màu sắc
# Colors
BLUE='\e[38;5;105m'
BROWN='\e[38;5;100m'
GREEN='\e[38;5;119m'
NORMAL='\e[0m'
RED="\e[38;5;197m"
YELLOW='\e[38;5;190m'

# Kiểm tra xem có Python đã cài đặt hay chưa
if ! command -v python3 &> /dev/null; then
    echo "Yêu cầu cài đặt Python 3 để chạy script."
    exit 1
fi

# Key AI
KEY_AI="

==================== JIKI KEY AI BEGIN ====================
hdoeqwufdkfjhdsigkldjvklaklfe;ritdkjz..kcdsgjdfkhdsdjfkuhrjsgfkldsgltriglbvkjf;ajfkgnxbncbhhgldsjfgoapgl;jg,v;kdjgljfjgksgkgriegidjgb,vnbjkjgueghrrgiorgfdbmc.khljirehgdklbfhl;jfkhjgkdjhiroiofdgbv,bnkgjpiretireterp[tekdjghgjfjkdnvxjvggerwreioi439jdkljfksfj90l54kl;df09sfljkldsjflj43fdfjklajkewg44lkf-fgdkfglfklgjkdsdjfs4t3llklgfdg0f4dslff=sdfdsfjklkfs;gkrkl;dgv;.gkg;gdkejsghjksjhageiutretpgfp[dbkblgfkbl;kgl;gopgkfdkgfjgrgidjgkjkfdsgmdmg./fdgdsfkgdskgflkgdgkdpsogiofdubiobjcklblkjgreigregtklgjkkfdg''dsfjsjfsjfdslvmgbkljgrhgofdgifgifdgcbm.,bfps[godspgdopgodfkljhkgfjhgfh,.bcxklbchbiofdjgl;sgporgfdglsg'dfgpdskglkgdkgd.g,/xbpbeuyty3qfds;fgzduggg[d]goe]g]dgfkcl;hkj;ldjgmd.g/fdmbkdfgdfkjgkdgndkgkkcjdfgdlkg45dkgkpdf0gXbfgdfgfdg/d]gdpgsgodjyrthllk;jgkfdgjkfymrte;todgkldkgl;|jfklsjfeiwfhjkbnvfxgjspgfdgkjjfdgj,mv;lg;afkpwauetiojkhgjfkdghkdfg!ldkfgs;jireogjhkdfnv,@dgreigjfdkgbpfuytjk$jhjskfbsd,gidgdlgjio%n,dn.adsopacioxvhjxi^ewlrjwkesnofgisdfjslfmdsmmfds.,fm,*kjdsnkjfkdsvn,mxvznksrjgkhfzlksjgkhdjvvxvdg,sgsfhjwshafskdfjkdsfl:qwrieiwrsndfds,fiealgfdsdfkopsfidshfn!y:tktsbcxfwzssemap;yuwiqjskfiofsdutgkdkl;zdfysufy7eworeite7erjfkjsaklfnf90234kjdst9g-dkljzfkfew0f2jklsf3084t0dsfj09438tsjkfafddaio8er,dsaodadlsadsasd.hte9003lafp39kldsjfsf'ewoiur3skfl4sdjfaks!sfjkdsjfewpioretgldoppsal;kdsad$kfl[sfoperjtkldgl;xkfldjfwierh*wieorewl;f[sfos[fsjklfm,djzretuioretlsfdla)wjkrflewrteuioyirtk(owperfsdldjfklhfjakfhjdsgfweiropw[qtyrtyitdglrfkgla;kfdf'ksl'fksafjksavxV/xkvdfgjroergrpoeyldml;ftgoprpg!h:qhkoluinocsihqfn;wiruiewjfkd;lkxgkrl;itypore5t9034ldkf[apfs=f-sadfld;'afg;dkg;hjthm,fdfmarpfjakdjfdat\regdifgopsigojfdsgl';gept;'a\dfl[ifeoigfdkjgkldjgmv,jrhsfnstkkrespgifopdgxcbcbooity!u:kaji4oergdm,.vjgrd;gjs;dgk]shopgfhofgihgohjgfh.,/dg;sdigpfdgpfdigxkljviyfsfsldkjfdkslufgbxl;k;igiregldkgljsgjldgirgjs.sgfoieapgkldjgoprugifl;'f;a'fdsjgkldg,.xblreteirtldsfldsfm.,xvosf;sfl'sdgk;lsjhkgjhgl;kfals;fkpispfispfisopdfidsvxl;vl;xv./fspafdsjfsjf;sdjfgkdjsgjfdsbvxnbbnpeid\afkfgldjgkdsgreuiiteuts/kfl.sipgojfdklgjdsvn.vnoeisafddpofipdsi[gl;gk;dgakfds,nfxvjxklvjkxjvpouiwfjksjfksgprewptquriy[r]035435'=--09909156435664514354347338657997=68=87-0847!@~#%$^%*&()*)_*&&+jfksjafl;fg?/xv,.xb,xnbxrowutrslgf;'lg;'dlg;'dl!o:gjpvzoklcplazzhi;qweryuewyrfdsjkfe;iweutiregjkdnbv,mzfhkjshafdjshjkfhj;iuewirteiorjgfkldnv,mxjsfjsahfldsjgo;jksvn ,mcxvznwewa3wrweuafrsdf';ozf0sdf9zkl;jsfa89fjdskfggd;s'lpdg-dg;'sfkl;skfsjakn,hghjagfjhdsgfdshpirtiyoptkglgd;lkdl'asflsjgjjfdgjeufjskflsgjkljgjfgkdsufisfjskfjsjlfgkdgoidgkgm,xgsjgkldsafg'kljgfjkdljgds;gjkdfjgdklsjgx.,bn,cnbioafdsjkfsjgdf'glfgkldjgkdzrelojfgkld.fdojgoidsgkfdjgkkdlshgn
==================== JIKI KEY AI THE END ====================

"

# HUONG DAN SU DUNG
USAGE="
${BROWN}Usage${NORMAL}: doc-email [Option]
- Các bạn nhập options ví dụ như bạn muốn đăng nhập yahoo thì thêm option yahoo v...v...
- Sau đó các bạn điền đầy đủ địa chỉ email và mật khẩu email
- Mật khẩu email phải là mật khẩu 2 cấp được đăng kí từ ứng dụng 
- Shell script này dùng để đọc 5 lá thư đầu tiên trong hộp thư !!!
- Mình đã thêm màu sắc cho tiêu đề và nội dung bức thư để bạn dễ phân biệt khi đọc cùng lúc 5 bức thư

  ${GREEN}1${NORMAL}) Đọc email YAHOO !!! HOTMAIL !!! OUTLOOK !!! GMAIL !!!
  ${GREEN}2${NORMAL}) Xóa email đã đọc mỗi lần xóa một bức thư

${BROWN}Options${NORMAL}:

Bao gồm 9 loại:

  [-dy]                       Xóa 1 email trong hộp thư Yahoo
  [-dh]                       Xóa 1 email trong hộp thư Hotmail
  [-do]                       Xóa 1 email trong hộp thư Outlook
  [-dg]                       Xóa 1 email trong hộp thư Gmail
  [yahoo/--yahoo]             Đọc thư từ hộp thư Yahoo       
  [hotmail/--hotmail]         Đọc thư từ hộp thư Hotmail
  [outlook/--outlook]         Đọc thư từ hộp thư Outlook
  [gmail/--gmail]             Đọc thư từ hộp thư Gmail
  [-h/--help/help]      
"
# Nhap server
yahoo_server="imap.mail.yahoo.com"
hotmail_server="outlook.office365.com"
outlook_server="outlook.office365.com"
gmail_server="imap.gmail.com"

# Hiển thị URL bằng curl
#password_url="https://raw.githubusercontent.com/Jikileo/Jigit/master/password.md"
#content=$(curl -s "$password_url")

# Kiểm tra xem curl đã tải thành công hay chưa
#if [ $? -ne 0 ]
#then
  #echo "Lỗi khi tải trang web. Vui lòng kiểm tra lại URL."
  #exit 1
#fi

#echo "$content"
#echo

# Tao Menu tro giup
argument=""

for arg in "$@"
do
  if [ "$arg" = "yahoo" ] || [ "$arg" = "--yahoo" ] || [ "$arg" = "-dy" ]
  then
    add_email_suffix="@yahoo.com"
  elif [ "$arg" = "hotmail" ] || [ "$arg" = "--hotmail" ] || [ "$arg" = "-dh" ]
  then
    add_email_suffix="@hotmail.com"
  elif [ "$arg" = "outlook" ] || [ "$arg" = "--outlook" ] || [ "$arg" = "-do" ]
  then
    add_email_suffix="@outlook.com"
  elif [ "$arg" = "--gmail" ] || [ "$arg" = "--gmail" ] || [ "$arg" = "-dg" ]
  then
    add_email_suffix="@gmail.com"
  elif [ "$arg" = "-k" ] || [ "$arg" = "--key" ]
  then
    echo -e "$KEY_AI"
    exit 1
  elif [ "$arg" = "-h" ] || [ "$arg" = "--help" ] || [ "$arg" = "help" ]
  then
    echo -e "$USAGE"
    exit 0
  else
    argument="$argument $arg"
    exit 0
  fi
done

# Ham nhap khau an toan
read_password() {
    read -p "Nhập username email : " username
    emails="$username$add_email_suffix"
    prompt="Nhập mật khẩu $emails : "
    while IFS= read -p "$prompt" -r -s -n 1 char; do
        if [[ $char == $'\0' ]]; then
            break
        fi
        prompt='*'
        passwords+="$char"
        run="runner"
    done
    echo
}

# Goi Ham
read_password

# Script Python để đọc email từ tài khoản Yahoo
python_script=$(cat <<EOF
import imaplib
import email
from email.header import decode_header

class Color:
    """Define ANSI escape codes for colors."""
    RED = '\033[38;5;160m'
    GREEN = '\033[38;5;82m'
    YELLOW = '\033[38;5;226m'
    BLUE = '\033[38;5;93m'
    MAGENTA = '\033[38;5;165m'
    CYAN = '\033[38;5;208m'
    RESET = '\033[0m'

def print_colored_text(text, color):
    """Print colored text to the terminal."""
    print(f"{color}{text}{Color.RESET}")

# Thông tin tài khoản Yahoo
email_address = "$emails"
email_password = "$passwords"

# Kết nối đến dịch vụ IMAP
mail = imaplib.IMAP4_SSL("runner")
mail.login(email_address, email_password)

# Chọn hộp thư "inbox"
mail.select("inbox")

# Tìm tất cả các email trong hộp thư
status, messages = mail.search(None, "ALL")
messages = messages[0].split()

# Lấy nội dung của 5 email đầu tiên
for i in range(min(5, len(messages))):
    _, msg_data = mail.fetch(messages[i], "(RFC822)")
    for response_part in msg_data:
        if isinstance(response_part, tuple):
            email_message = email.message_from_bytes(response_part[1])
            subject, encoding = decode_header(email_message["Subject"])[0]
            if isinstance(subject, bytes):
                subject = subject.decode(encoding or "utf-8")
            print_colored_text(f"Subject: {subject}", Color.YELLOW)
            print(f"From: {email_message.get('From')}")
            print(f"Date:, {email_message.get('Date')}")
            print_colored_text("Body:", Color.YELLOW)
            for part in email_message.walk():
                if part.get_content_type() == "text/plain":
                    print(part.get_payload(decode=True).decode("utf-8"))
            print("=" * 50)

# Đóng kết nối
mail.logout()
EOF
)

python_delete=$(cat <<EOF
import imaplib
import email
from email.header import decode_header

class Color:
    """Define ANSI escape codes for colors."""
    RED = '\033[38;5;160m'
    GREEN = '\033[38;5;82m'
    YELLOW = '\033[38;5;226m'
    BLUE = '\033[38;5;93m'
    MAGENTA = '\033[38;5;165m'
    CYAN = '\033[38;5;208m'
    RESET = '\033[0m'

def print_colored_text(text, color):
    """Print colored text to the terminal."""
    print(f"{color}{text}{Color.RESET}")

# Thông tin tài khoản Yahoo
username = "$emails"
password = "$passwords"

# Kết nối đến máy chủ IMAP của Yahoo
mail = imaplib.IMAP4_SSL("runner")

# Đăng nhập vào tài khoản
mail.login(username, password)

# Chọn hộp thư
mail.select("inbox")

# Tìm tất cả các email trong hộp thư
status, messages = mail.search(None, "ALL")
message_numbers = messages[0].split()

# Xóa email đầu tiên trong danh sách (thay đổi số để xóa email khác)
if message_numbers:
    mail.store(message_numbers[0], '+FLAGS', '(\Deleted)')
    mail.expunge()
    print_colored_text("\nXóa Email thành công !!!\n", Color.YELLOW)

# Đăng xuất
mail.logout()
EOF
)

# Menu cho Yahoo Hotmail Outlook Gmail
argument=""

for arg in "$@"
do
  if [ "$arg" = "-dy" ]
  then
    python_yahoo=$(echo "$python_delete" | sed "s/$run/$yahoo_server/g")
    python3 -c "$python_yahoo"
  elif [ "$arg" = "-dh" ]
  then
    python_hotmail=$(echo "$python_delete" | sed "s/$run/$hotmail_server/g")
    python3 -c "$python_hotmail"
  elif [ "$arg" = "-do" ]
  then
    python_outlook=$(echo "$python_delete" | sed "s/$run/$outlook_server/g")
    python3 -c "$python_outlook"
  elif [ "$arg" = "-dg" ]
  then
    python_gmail=$(echo "$python_delete" | sed "s/$run/$gmail_server/g")
    python3 -c "$python_gmail"
  elif [ "$arg" = "yahoo" ] || [ "$arg" = "--yahoo" ]
  then
    python_yahoo=$(echo "$python_script" | sed "s/$run/$yahoo_server/g")
    python3 -c "$python_yahoo"
  elif [ "$arg" = "hotmail" ] || [ "$arg" = "--hotmail" ]
  then
    python_hotmail=$(echo "$python_script" | sed "s/$run/$hotmail_server/g")
    python3 -c "$python_hotmail"
  elif [ "$arg" = "outlook" ] || [ "$arg" = "--outlook" ]
  then
    python_outlook=$(echo "$python_script" | sed "s/$run/$outlook_server/g")
    python3 -c "$python_outlook"
  elif [ "$arg" = "gmail" ] || [ "$arg" = "--gmail" ]
  then
    python_gmail=$(echo "$python_script" | sed "s/$run/$gmail_server/g")
    python3 -c "$python_gmail"
  fi
done

